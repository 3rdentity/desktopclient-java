
apply plugin: 'java'

sourceCompatibility = '1.7'
targetCompatibility = '1.7'

// no way to detect that?
ext.mainClass = 'org.kontalk.Kontalk'

//[compileJava, compileTestJava]*.options*.encoding = 'UTF-8'

buildDir = 'build_gradle'

sourceSets {
    main {
        java {
            srcDir 'client-common-java/src/main/java'
        }
    }
}

dependencies {
//    testCompile group: 'junit', name: 'junit', version: '4.10'
    compile fileTree(dir: 'lib', include: ['*.jar'])
}

//repositories {
//// mavenCentral()
//   flatDir {
//       dirs 'lib'
//   }
//}

jar {
    manifest {
        attributes "Main-Class": mainClass
    }

    doFirst {
        from {
            configurations.compile.collect {
                it.isDirectory() ? it : zipTree(it)
            }
        }
    }
    exclude 'META-INF/*.RSA', 'META-INF/*.SF','META-INF/*.DSA'
}

task execute(type:JavaExec) {
   main = mainClass
   classpath = sourceSets.main.runtimeClasspath
}

// NetBeans will automatically add "run" and "debug" tasks relying on the
// "mainClass" property. You may however define the property prior executing
// tasks by passing a "-PmainClass=<QUALIFIED_CLASS_NAME>" argument.
// Note however, that you may define your own "run" and "debug" task if you
// prefer. In this case NetBeans will not add these tasks but you may rely on
// your own implementation.
